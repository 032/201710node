{"version":3,"sources":["../../../../node-day5/The-fourth-chapter/课件7res上新增方法/10.res.js"],"names":["express","require","app","listen","get","req","res","json","name","age","sendFile","join","__dirname","sendStatus","send","use","next","mysend","data","setHeader","end","JSON","stringify","statusCode","STATUS_CODES"],"mappings":";;;;AAAA,IAAIA,UAAQC,QAAQ,SAAR,CAAZ;AACA,IAAIC,MAAMF,SAAV;AACAE,IAAIC,MAAJ,CAAW,IAAX;;AAEA;AACA;AACA;AACA;AACA;AACAD,IAAIE,GAAJ,CAAQ,OAAR,EAAgB,UAAUC,GAAV,EAAcC,GAAd,EAAmB;AAC/BA,QAAIC,IAAJ,CAAS,EAACC,MAAK,IAAN,EAAWC,KAAI,EAAf,EAAT;AACH,CAFD;;AAIA;AACA;AACAP,IAAIE,GAAJ,CAAQ,GAAR,EAAY,UAAUC,GAAV,EAAcC,GAAd,EAAmB;AAC3B;AACF;AACA;AACA;;AAEEA,QAAII,QAAJ,CAAaT,QAAQ,MAAR,EAAgBU,IAAhB,CAAqBC,SAArB,EAA+B,IAA/B,EAAoC,YAApC,CAAb,EAN2B,CAMoC;AAClE,CAPD;AAQCV,IAAIE,GAAJ,CAAQ,SAAR,EAAkB,UAAUC,GAAV,EAAcC,GAAd,EAAmB;AACjCA,QAAIO,UAAJ,CAAe,GAAf;AACH,CAFD;AAGDX,IAAIE,GAAJ,CAAQ,OAAR,EAAgB,UAAUC,GAAV,EAAcC,GAAd,EAAmB;AAC/B;AACAA,QAAIQ,IAAJ,CAAS,IAAT,EAF+B,CAEjB;AAEjB,CAJD;;AAQA;AACAZ,IAAIa,GAAJ,CAAQ,UAAUV,GAAV,EAAcC,GAAd,EAAkBU,IAAlB,EAAwB;AAC5BV,QAAIW,MAAJ,GAAW,UAAUC,IAAV,EAAgB;AACvB,YAAI,QAAOA,IAAP,yCAAOA,IAAP,MAAe,QAAnB,EACA;AACIZ,gBAAIa,SAAJ,CAAc,cAAd,EAA6B,+BAA7B;AACA,mBAAOb,IAAIc,GAAJ,CAAQC,KAAKC,SAAL,CAAeJ,IAAf,CAAR,CAAP;AACH;AACD,YAAI,OAAOA,IAAP,IAAe,QAAnB,EACA;AACIZ,gBAAIa,SAAJ,CAAc,cAAd,EAA6B,yBAA7B;AACA,mBAAOb,IAAIc,GAAJ,CAAQF,IAAR,CAAP;AACH;AACD,YAAI,OAAOA,IAAP,IAAe,QAAnB,EAA6B;;AAEzBZ,gBAAIiB,UAAJ,GAAiBL,IAAjB;AACA,mBAAOZ,IAAIc,GAAJ,CAAQnB,QAAQ,cAAR,EAAwBuB,YAAxB,CAAqCN,IAArC,CAAR,CAAP,CAHyB,CAGiC;AAC7D;AACJ,KAhBD;AAiBAF;AACH,CAnBD;AAoBAd,IAAIE,GAAJ,CAAQ,SAAR,EAAkB,UAAUC,GAAV,EAAcC,GAAd,EAAmB;AACjC;AACAA,QAAIW,MAAJ,CAAW,GAAX,EAFiC,CAElB;AAClB,CAHD","file":"10.res.js","sourcesContent":["let express=require('express')\nlet app = express()\napp.listen(8080)\n\n//不能直接返回对象res.json()//返回json的\n//返回html页面\n//res.sendFile()//返回文件\n//res.statusCode  res.end =>res.sendStatus()\n//res.end res.header()=> res.send()\napp.get('/json',function (req,res) {\n    res.json({name:'春利',age:19})\n})\n\n//路由是严格匹配的 但是 中间件use并不是严格匹配\n//  不能通过..／查找（root是不支持的） 想读取到确切的文件 用path模块进行拼接即可\napp.get('/',function (req,res) {\n    // fs.createReadStream('./index.html').pipe()这是以前的写法\n  //res.sendFile('./index.html') //TypeError: path must be absolute or specify root to res.sendFile\n  //   res.sendFile(__dirname+'/index.html')//我很帅\n  //   res.sendFile('./index.html',{root:__dirname})//我很帅\n\n    res.sendFile(require('path').join(__dirname,'..','index.html'))//Forbidden  //不能通过../来访问上一级目录\n})\n app.get('/status',function (req,res) {\n     res.sendStatus(404)\n })\napp.get('/send',function (req,res) {\n    // res.send(404)//Not Found  send方法有判断转换的功能\n    res.send('中文')//中文\n\n})\n\n\n\n//其内部实现如下\napp.use(function (req,res,next) {\n    res.mysend=function (data) {\n        if (typeof data == \"object\")\n        {\n            res.setHeader('Content-Type','application/json;charset=utf8')\n            return res.end(JSON.stringify(data))\n        }\n        if (typeof data == \"string\")\n        {\n            res.setHeader('Content-Type','text/plain;charset=utf8')\n            return res.end(data)\n        }\n        if (typeof data == \"number\") {\n\n            res.statusCode = data\n            return res.end(require('_http_server').STATUS_CODES[data])//OK\n        }\n    }\n    next()\n})\napp.get('/mySend',function (req,res) {\n    // res.send(404)//Not Found  send方法有判断转换的功能\n    res.mysend(200)//中文\n})\n"]}